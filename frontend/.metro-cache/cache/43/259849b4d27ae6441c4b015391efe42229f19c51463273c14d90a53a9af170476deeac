{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":57,"index":57}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"expo-secure-store","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":99},"end":{"line":3,"column":49,"index":148}}],"key":"BU2XtfznZ4PiVldqd/oueHCCaLo=","exportNames":["*"],"imports":1}},{"name":"../utils/config","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":149},"end":{"line":4,"column":46,"index":195}}],"key":"WFOFv9lb6DeSdo+xE9xAz1AQrFI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  exports.useSubscription = useSubscription;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeWebDistExportsPlatform = require(_dependencyMap[1], \"react-native-web/dist/exports/Platform\");\n  var Platform = _interopDefault(_reactNativeWebDistExportsPlatform);\n  var _expoSecureStore = require(_dependencyMap[2], \"expo-secure-store\");\n  var SecureStore = _interopNamespace(_expoSecureStore);\n  var _utilsConfig = require(_dependencyMap[3], \"../utils/config\");\n  const getToken = async () => {\n    if (Platform.default.OS === 'web') {\n      return localStorage.getItem('auth_token');\n    }\n    return await SecureStore.getItemAsync('auth_token');\n  };\n  const DEFAULT_STATUS = {\n    subscription_tier: 'free',\n    is_pro: false,\n    expires_at: null,\n    limits: {\n      max_friends: 5,\n      photos_per_visit: 1,\n      can_access_premium_landmarks: false,\n      can_create_custom_visits: false\n    },\n    usage: {\n      friends_count: 0,\n      friends_limit: 5,\n      friends_remaining: 5\n    }\n  };\n  function useSubscription() {\n    _s();\n    const [status, setStatus] = (0, _react.useState)(DEFAULT_STATUS);\n    const [loading, setLoading] = (0, _react.useState)(true);\n    const [error, setError] = (0, _react.useState)(null);\n    const fetchStatus = (0, _react.useCallback)(async () => {\n      try {\n        setLoading(true);\n        const token = await getToken();\n        if (!token) {\n          setStatus(DEFAULT_STATUS);\n          return;\n        }\n        const response = await fetch(`${_utilsConfig.BACKEND_URL}/api/subscription/status`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        if (response.ok) {\n          const data = await response.json();\n          setStatus(data);\n          setError(null);\n        } else {\n          // If endpoint doesn't exist or fails, assume free tier\n          setStatus(DEFAULT_STATUS);\n        }\n      } catch (err) {\n        console.error('Error fetching subscription:', err);\n        setStatus(DEFAULT_STATUS);\n        setError('Failed to fetch subscription status');\n      } finally {\n        setLoading(false);\n      }\n    }, []);\n    (0, _react.useEffect)(() => {\n      fetchStatus();\n    }, [fetchStatus]);\n    const refresh = (0, _react.useCallback)(() => {\n      fetchStatus();\n    }, [fetchStatus]);\n\n    // Helper functions\n    const isPro = status.is_pro;\n    const canAccessPremiumLandmarks = status.limits.can_access_premium_landmarks;\n    const canCreateCustomVisits = status.limits.can_create_custom_visits;\n    const maxPhotosPerVisit = status.limits.photos_per_visit;\n    const maxFriends = status.limits.max_friends;\n    const friendsRemaining = status.usage.friends_remaining;\n    const isAtFriendLimit = status.usage.friends_remaining <= 0;\n    return {\n      status,\n      loading,\n      error,\n      refresh,\n      // Quick access helpers\n      isPro,\n      canAccessPremiumLandmarks,\n      canCreateCustomVisits,\n      maxPhotosPerVisit,\n      maxFriends,\n      friendsRemaining,\n      isAtFriendLimit\n    };\n  }\n  _s(useSubscription, \"Ew1PJgfGcV+5McCQx5JpYm4HgyY=\");\n});","lineCount":122,"map":[[28,2,47,0,"exports"],[28,9,47,0],[28,10,47,0,"useSubscription"],[28,25,47,0],[28,28,47,0,"useSubscription"],[28,43,47,0],[29,2,1,0],[29,6,1,0,"_react"],[29,12,1,0],[29,15,1,0,"require"],[29,22,1,0],[29,23,1,0,"_dependencyMap"],[29,37,1,0],[30,2,1,57],[30,6,1,57,"_reactNativeWebDistExportsPlatform"],[30,40,1,57],[30,43,1,57,"require"],[30,50,1,57],[30,51,1,57,"_dependencyMap"],[30,65,1,57],[31,2,1,57],[31,6,1,57,"Platform"],[31,14,1,57],[31,17,1,57,"_interopDefault"],[31,32,1,57],[31,33,1,57,"_reactNativeWebDistExportsPlatform"],[31,67,1,57],[32,2,3,0],[32,6,3,0,"_expoSecureStore"],[32,22,3,0],[32,25,3,0,"require"],[32,32,3,0],[32,33,3,0,"_dependencyMap"],[32,47,3,0],[33,2,3,0],[33,6,3,0,"SecureStore"],[33,17,3,0],[33,20,3,0,"_interopNamespace"],[33,37,3,0],[33,38,3,0,"_expoSecureStore"],[33,54,3,0],[34,2,4,0],[34,6,4,0,"_utilsConfig"],[34,18,4,0],[34,21,4,0,"require"],[34,28,4,0],[34,29,4,0,"_dependencyMap"],[34,43,4,0],[35,2,6,0],[35,8,6,6,"getToken"],[35,16,6,14],[35,19,6,17],[35,25,6,17,"getToken"],[35,26,6,17],[35,31,6,53],[36,4,7,2],[36,8,7,6,"Platform"],[36,16,7,14],[36,17,7,14,"default"],[36,24,7,14],[36,25,7,15,"OS"],[36,27,7,17],[36,32,7,22],[36,37,7,27],[36,39,7,29],[37,6,8,4],[37,13,8,11,"localStorage"],[37,25,8,23],[37,26,8,24,"getItem"],[37,33,8,31],[37,34,8,32],[37,46,8,44],[37,47,8,45],[38,4,9,2],[39,4,10,2],[39,11,10,9],[39,17,10,15,"SecureStore"],[39,28,10,26],[39,29,10,27,"getItemAsync"],[39,41,10,39],[39,42,10,40],[39,54,10,52],[39,55,10,53],[40,2,11,0],[40,3,11,1],[41,2,30,0],[41,8,30,6,"DEFAULT_STATUS"],[41,22,30,40],[41,25,30,43],[42,4,31,2,"subscription_tier"],[42,21,31,19],[42,23,31,21],[42,29,31,27],[43,4,32,2,"is_pro"],[43,10,32,8],[43,12,32,10],[43,17,32,15],[44,4,33,2,"expires_at"],[44,14,33,12],[44,16,33,14],[44,20,33,18],[45,4,34,2,"limits"],[45,10,34,8],[45,12,34,10],[46,6,35,4,"max_friends"],[46,17,35,15],[46,19,35,17],[46,20,35,18],[47,6,36,4,"photos_per_visit"],[47,22,36,20],[47,24,36,22],[47,25,36,23],[48,6,37,4,"can_access_premium_landmarks"],[48,34,37,32],[48,36,37,34],[48,41,37,39],[49,6,38,4,"can_create_custom_visits"],[49,30,38,28],[49,32,38,30],[50,4,39,2],[50,5,39,3],[51,4,40,2,"usage"],[51,9,40,7],[51,11,40,9],[52,6,41,4,"friends_count"],[52,19,41,17],[52,21,41,19],[52,22,41,20],[53,6,42,4,"friends_limit"],[53,19,42,17],[53,21,42,19],[53,22,42,20],[54,6,43,4,"friends_remaining"],[54,23,43,21],[54,25,43,23],[55,4,44,2],[56,2,45,0],[56,3,45,1],[57,2,47,7],[57,11,47,16,"useSubscription"],[57,26,47,31,"useSubscription"],[57,27,47,31],[57,29,47,34],[58,4,47,34,"_s"],[58,6,47,34],[59,4,48,2],[59,10,48,8],[59,11,48,9,"status"],[59,17,48,15],[59,19,48,17,"setStatus"],[59,28,48,26],[59,29,48,27],[59,32,48,30],[59,36,48,30,"useState"],[59,42,48,38],[59,43,48,38,"useState"],[59,51,48,38],[59,53,48,59,"DEFAULT_STATUS"],[59,67,48,73],[59,68,48,74],[60,4,49,2],[60,10,49,8],[60,11,49,9,"loading"],[60,18,49,16],[60,20,49,18,"setLoading"],[60,30,49,28],[60,31,49,29],[60,34,49,32],[60,38,49,32,"useState"],[60,44,49,40],[60,45,49,40,"useState"],[60,53,49,40],[60,55,49,41],[60,59,49,45],[60,60,49,46],[61,4,50,2],[61,10,50,8],[61,11,50,9,"error"],[61,16,50,14],[61,18,50,16,"setError"],[61,26,50,24],[61,27,50,25],[61,30,50,28],[61,34,50,28,"useState"],[61,40,50,36],[61,41,50,36,"useState"],[61,49,50,36],[61,51,50,52],[61,55,50,56],[61,56,50,57],[62,4,52,2],[62,10,52,8,"fetchStatus"],[62,21,52,19],[62,24,52,22],[62,28,52,22,"useCallback"],[62,34,52,33],[62,35,52,33,"useCallback"],[62,46,52,33],[62,48,52,34],[62,60,52,46],[63,6,53,4],[63,10,53,8],[64,8,54,6,"setLoading"],[64,18,54,16],[64,19,54,17],[64,23,54,21],[64,24,54,22],[65,8,55,6],[65,14,55,12,"token"],[65,19,55,17],[65,22,55,20],[65,28,55,26,"getToken"],[65,36,55,34],[65,37,55,35],[65,38,55,36],[66,8,57,6],[66,12,57,10],[66,13,57,11,"token"],[66,18,57,16],[66,20,57,18],[67,10,58,8,"setStatus"],[67,19,58,17],[67,20,58,18,"DEFAULT_STATUS"],[67,34,58,32],[67,35,58,33],[68,10,59,8],[69,8,60,6],[70,8,62,6],[70,14,62,12,"response"],[70,22,62,20],[70,25,62,23],[70,31,62,29,"fetch"],[70,36,62,34],[70,37,62,35],[70,40,62,38,"BACKEND_URL"],[70,52,62,49],[70,53,62,49,"BACKEND_URL"],[70,64,62,49],[70,90,62,75],[70,92,62,77],[71,10,63,8,"headers"],[71,17,63,15],[71,19,63,17],[72,12,63,19,"Authorization"],[72,25,63,32],[72,27,63,34],[72,37,63,44,"token"],[72,42,63,49],[73,10,63,52],[74,8,64,6],[74,9,64,7],[74,10,64,8],[75,8,66,6],[75,12,66,10,"response"],[75,20,66,18],[75,21,66,19,"ok"],[75,23,66,21],[75,25,66,23],[76,10,67,8],[76,16,67,14,"data"],[76,20,67,18],[76,23,67,21],[76,29,67,27,"response"],[76,37,67,35],[76,38,67,36,"json"],[76,42,67,40],[76,43,67,41],[76,44,67,42],[77,10,68,8,"setStatus"],[77,19,68,17],[77,20,68,18,"data"],[77,24,68,22],[77,25,68,23],[78,10,69,8,"setError"],[78,18,69,16],[78,19,69,17],[78,23,69,21],[78,24,69,22],[79,8,70,6],[79,9,70,7],[79,15,70,13],[80,10,71,8],[81,10,72,8,"setStatus"],[81,19,72,17],[81,20,72,18,"DEFAULT_STATUS"],[81,34,72,32],[81,35,72,33],[82,8,73,6],[83,6,74,4],[83,7,74,5],[83,8,74,6],[83,15,74,13,"err"],[83,18,74,16],[83,20,74,18],[84,8,75,6,"console"],[84,15,75,13],[84,16,75,14,"error"],[84,21,75,19],[84,22,75,20],[84,52,75,50],[84,54,75,52,"err"],[84,57,75,55],[84,58,75,56],[85,8,76,6,"setStatus"],[85,17,76,15],[85,18,76,16,"DEFAULT_STATUS"],[85,32,76,30],[85,33,76,31],[86,8,77,6,"setError"],[86,16,77,14],[86,17,77,15],[86,54,77,52],[86,55,77,53],[87,6,78,4],[87,7,78,5],[87,16,78,14],[88,8,79,6,"setLoading"],[88,18,79,16],[88,19,79,17],[88,24,79,22],[88,25,79,23],[89,6,80,4],[90,4,81,2],[90,5,81,3],[90,7,81,5],[90,9,81,7],[90,10,81,8],[91,4,83,2],[91,8,83,2,"useEffect"],[91,14,83,11],[91,15,83,11,"useEffect"],[91,24,83,11],[91,26,83,12],[91,32,83,18],[92,6,84,4,"fetchStatus"],[92,17,84,15],[92,18,84,16],[92,19,84,17],[93,4,85,2],[93,5,85,3],[93,7,85,5],[93,8,85,6,"fetchStatus"],[93,19,85,17],[93,20,85,18],[93,21,85,19],[94,4,87,2],[94,10,87,8,"refresh"],[94,17,87,15],[94,20,87,18],[94,24,87,18,"useCallback"],[94,30,87,29],[94,31,87,29,"useCallback"],[94,42,87,29],[94,44,87,30],[94,50,87,36],[95,6,88,4,"fetchStatus"],[95,17,88,15],[95,18,88,16],[95,19,88,17],[96,4,89,2],[96,5,89,3],[96,7,89,5],[96,8,89,6,"fetchStatus"],[96,19,89,17],[96,20,89,18],[96,21,89,19],[98,4,91,2],[99,4,92,2],[99,10,92,8,"isPro"],[99,15,92,13],[99,18,92,16,"status"],[99,24,92,22],[99,25,92,23,"is_pro"],[99,31,92,29],[100,4,93,2],[100,10,93,8,"canAccessPremiumLandmarks"],[100,35,93,33],[100,38,93,36,"status"],[100,44,93,42],[100,45,93,43,"limits"],[100,51,93,49],[100,52,93,50,"can_access_premium_landmarks"],[100,80,93,78],[101,4,94,2],[101,10,94,8,"canCreateCustomVisits"],[101,31,94,29],[101,34,94,32,"status"],[101,40,94,38],[101,41,94,39,"limits"],[101,47,94,45],[101,48,94,46,"can_create_custom_visits"],[101,72,94,70],[102,4,95,2],[102,10,95,8,"maxPhotosPerVisit"],[102,27,95,25],[102,30,95,28,"status"],[102,36,95,34],[102,37,95,35,"limits"],[102,43,95,41],[102,44,95,42,"photos_per_visit"],[102,60,95,58],[103,4,96,2],[103,10,96,8,"maxFriends"],[103,20,96,18],[103,23,96,21,"status"],[103,29,96,27],[103,30,96,28,"limits"],[103,36,96,34],[103,37,96,35,"max_friends"],[103,48,96,46],[104,4,97,2],[104,10,97,8,"friendsRemaining"],[104,26,97,24],[104,29,97,27,"status"],[104,35,97,33],[104,36,97,34,"usage"],[104,41,97,39],[104,42,97,40,"friends_remaining"],[104,59,97,57],[105,4,98,2],[105,10,98,8,"isAtFriendLimit"],[105,25,98,23],[105,28,98,26,"status"],[105,34,98,32],[105,35,98,33,"usage"],[105,40,98,38],[105,41,98,39,"friends_remaining"],[105,58,98,56],[105,62,98,60],[105,63,98,61],[106,4,100,2],[106,11,100,9],[107,6,101,4,"status"],[107,12,101,10],[108,6,102,4,"loading"],[108,13,102,11],[109,6,103,4,"error"],[109,11,103,9],[110,6,104,4,"refresh"],[110,13,104,11],[111,6,105,4],[112,6,106,4,"isPro"],[112,11,106,9],[113,6,107,4,"canAccessPremiumLandmarks"],[113,31,107,29],[114,6,108,4,"canCreateCustomVisits"],[114,27,108,25],[115,6,109,4,"maxPhotosPerVisit"],[115,23,109,21],[116,6,110,4,"maxFriends"],[116,16,110,14],[117,6,111,4,"friendsRemaining"],[117,22,111,20],[118,6,112,4,"isAtFriendLimit"],[119,4,113,2],[119,5,113,3],[120,2,114,0],[121,2,114,1,"_s"],[121,4,114,1],[121,5,47,16,"useSubscription"],[121,20,47,31],[122,0,47,31],[122,3]],"functionMap":{"names":["<global>","getToken","useSubscription","fetchStatus","useEffect$argument_0","refresh"],"mappings":"AAA;iBCK;CDK;OEoC;kCCK;GD6B;YEE;GFE;8BGE;GHE;CFyB"},"hasCjsExports":false},"type":"js/module"}]}