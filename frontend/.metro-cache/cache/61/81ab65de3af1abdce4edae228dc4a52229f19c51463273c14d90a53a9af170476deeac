{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":57,"index":57}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"expo-secure-store","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":99},"end":{"line":3,"column":49,"index":148}}],"key":"BU2XtfznZ4PiVldqd/oueHCCaLo=","exportNames":["*"],"imports":1}},{"name":"../utils/config","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":149},"end":{"line":4,"column":46,"index":195}}],"key":"WFOFv9lb6DeSdo+xE9xAz1AQrFI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  exports.useSubscription = useSubscription;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeWebDistExportsPlatform = require(_dependencyMap[1], \"react-native-web/dist/exports/Platform\");\n  var Platform = _interopDefault(_reactNativeWebDistExportsPlatform);\n  var _expoSecureStore = require(_dependencyMap[2], \"expo-secure-store\");\n  var SecureStore = _interopNamespace(_expoSecureStore);\n  var _utilsConfig = require(_dependencyMap[3], \"../utils/config\");\n  const getToken = async () => {\n    if (Platform.default.OS === 'web') {\n      return localStorage.getItem('auth_token');\n    }\n    return await SecureStore.getItemAsync('auth_token');\n  };\n  const DEFAULT_STATUS = {\n    subscription_tier: 'free',\n    is_pro: false,\n    expires_at: null,\n    limits: {\n      max_friends: 5,\n      photos_per_visit: 1,\n      can_access_premium_landmarks: false,\n      can_create_custom_visits: false\n    },\n    usage: {\n      friends_count: 0,\n      friends_limit: 5,\n      friends_remaining: 5\n    }\n  };\n  function useSubscription() {\n    const [status, setStatus] = (0, _react.useState)(DEFAULT_STATUS);\n    const [loading, setLoading] = (0, _react.useState)(true);\n    const [error, setError] = (0, _react.useState)(null);\n    const fetchStatus = (0, _react.useCallback)(async () => {\n      try {\n        setLoading(true);\n        const token = await getToken();\n        if (!token) {\n          setStatus(DEFAULT_STATUS);\n          return;\n        }\n        const response = await fetch(`${_utilsConfig.BACKEND_URL}/api/subscription/status`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        if (response.ok) {\n          const data = await response.json();\n          setStatus(data);\n          setError(null);\n        } else {\n          // If endpoint doesn't exist or fails, assume free tier\n          setStatus(DEFAULT_STATUS);\n        }\n      } catch (err) {\n        console.error('Error fetching subscription:', err);\n        setStatus(DEFAULT_STATUS);\n        setError('Failed to fetch subscription status');\n      } finally {\n        setLoading(false);\n      }\n    }, []);\n    (0, _react.useEffect)(() => {\n      fetchStatus();\n    }, [fetchStatus]);\n    const refresh = (0, _react.useCallback)(() => {\n      fetchStatus();\n    }, [fetchStatus]);\n\n    // Helper functions\n    const isPro = status.is_pro;\n    const canAccessPremiumLandmarks = status.limits.can_access_premium_landmarks;\n    const canCreateCustomVisits = status.limits.can_create_custom_visits;\n    const maxPhotosPerVisit = status.limits.photos_per_visit;\n    const maxFriends = status.limits.max_friends;\n    const friendsRemaining = status.usage.friends_remaining;\n    const isAtFriendLimit = status.usage.friends_remaining <= 0;\n    return {\n      status,\n      loading,\n      error,\n      refresh,\n      // Quick access helpers\n      isPro,\n      canAccessPremiumLandmarks,\n      canCreateCustomVisits,\n      maxPhotosPerVisit,\n      maxFriends,\n      friendsRemaining,\n      isAtFriendLimit\n    };\n  }\n});","lineCount":119,"map":[[27,2,47,0,"exports"],[27,9,47,0],[27,10,47,0,"useSubscription"],[27,25,47,0],[27,28,47,0,"useSubscription"],[27,43,47,0],[28,2,1,0],[28,6,1,0,"_react"],[28,12,1,0],[28,15,1,0,"require"],[28,22,1,0],[28,23,1,0,"_dependencyMap"],[28,37,1,0],[29,2,1,57],[29,6,1,57,"_reactNativeWebDistExportsPlatform"],[29,40,1,57],[29,43,1,57,"require"],[29,50,1,57],[29,51,1,57,"_dependencyMap"],[29,65,1,57],[30,2,1,57],[30,6,1,57,"Platform"],[30,14,1,57],[30,17,1,57,"_interopDefault"],[30,32,1,57],[30,33,1,57,"_reactNativeWebDistExportsPlatform"],[30,67,1,57],[31,2,3,0],[31,6,3,0,"_expoSecureStore"],[31,22,3,0],[31,25,3,0,"require"],[31,32,3,0],[31,33,3,0,"_dependencyMap"],[31,47,3,0],[32,2,3,0],[32,6,3,0,"SecureStore"],[32,17,3,0],[32,20,3,0,"_interopNamespace"],[32,37,3,0],[32,38,3,0,"_expoSecureStore"],[32,54,3,0],[33,2,4,0],[33,6,4,0,"_utilsConfig"],[33,18,4,0],[33,21,4,0,"require"],[33,28,4,0],[33,29,4,0,"_dependencyMap"],[33,43,4,0],[34,2,6,0],[34,8,6,6,"getToken"],[34,16,6,14],[34,19,6,17],[34,25,6,17,"getToken"],[34,26,6,17],[34,31,6,53],[35,4,7,2],[35,8,7,6,"Platform"],[35,16,7,14],[35,17,7,14,"default"],[35,24,7,14],[35,25,7,15,"OS"],[35,27,7,17],[35,32,7,22],[35,37,7,27],[35,39,7,29],[36,6,8,4],[36,13,8,11,"localStorage"],[36,25,8,23],[36,26,8,24,"getItem"],[36,33,8,31],[36,34,8,32],[36,46,8,44],[36,47,8,45],[37,4,9,2],[38,4,10,2],[38,11,10,9],[38,17,10,15,"SecureStore"],[38,28,10,26],[38,29,10,27,"getItemAsync"],[38,41,10,39],[38,42,10,40],[38,54,10,52],[38,55,10,53],[39,2,11,0],[39,3,11,1],[40,2,30,0],[40,8,30,6,"DEFAULT_STATUS"],[40,22,30,40],[40,25,30,43],[41,4,31,2,"subscription_tier"],[41,21,31,19],[41,23,31,21],[41,29,31,27],[42,4,32,2,"is_pro"],[42,10,32,8],[42,12,32,10],[42,17,32,15],[43,4,33,2,"expires_at"],[43,14,33,12],[43,16,33,14],[43,20,33,18],[44,4,34,2,"limits"],[44,10,34,8],[44,12,34,10],[45,6,35,4,"max_friends"],[45,17,35,15],[45,19,35,17],[45,20,35,18],[46,6,36,4,"photos_per_visit"],[46,22,36,20],[46,24,36,22],[46,25,36,23],[47,6,37,4,"can_access_premium_landmarks"],[47,34,37,32],[47,36,37,34],[47,41,37,39],[48,6,38,4,"can_create_custom_visits"],[48,30,38,28],[48,32,38,30],[49,4,39,2],[49,5,39,3],[50,4,40,2,"usage"],[50,9,40,7],[50,11,40,9],[51,6,41,4,"friends_count"],[51,19,41,17],[51,21,41,19],[51,22,41,20],[52,6,42,4,"friends_limit"],[52,19,42,17],[52,21,42,19],[52,22,42,20],[53,6,43,4,"friends_remaining"],[53,23,43,21],[53,25,43,23],[54,4,44,2],[55,2,45,0],[55,3,45,1],[56,2,47,7],[56,11,47,16,"useSubscription"],[56,26,47,31,"useSubscription"],[56,27,47,31],[56,29,47,34],[57,4,48,2],[57,10,48,8],[57,11,48,9,"status"],[57,17,48,15],[57,19,48,17,"setStatus"],[57,28,48,26],[57,29,48,27],[57,32,48,30],[57,36,48,30,"useState"],[57,42,48,38],[57,43,48,38,"useState"],[57,51,48,38],[57,53,48,59,"DEFAULT_STATUS"],[57,67,48,73],[57,68,48,74],[58,4,49,2],[58,10,49,8],[58,11,49,9,"loading"],[58,18,49,16],[58,20,49,18,"setLoading"],[58,30,49,28],[58,31,49,29],[58,34,49,32],[58,38,49,32,"useState"],[58,44,49,40],[58,45,49,40,"useState"],[58,53,49,40],[58,55,49,41],[58,59,49,45],[58,60,49,46],[59,4,50,2],[59,10,50,8],[59,11,50,9,"error"],[59,16,50,14],[59,18,50,16,"setError"],[59,26,50,24],[59,27,50,25],[59,30,50,28],[59,34,50,28,"useState"],[59,40,50,36],[59,41,50,36,"useState"],[59,49,50,36],[59,51,50,52],[59,55,50,56],[59,56,50,57],[60,4,52,2],[60,10,52,8,"fetchStatus"],[60,21,52,19],[60,24,52,22],[60,28,52,22,"useCallback"],[60,34,52,33],[60,35,52,33,"useCallback"],[60,46,52,33],[60,48,52,34],[60,60,52,46],[61,6,53,4],[61,10,53,8],[62,8,54,6,"setLoading"],[62,18,54,16],[62,19,54,17],[62,23,54,21],[62,24,54,22],[63,8,55,6],[63,14,55,12,"token"],[63,19,55,17],[63,22,55,20],[63,28,55,26,"getToken"],[63,36,55,34],[63,37,55,35],[63,38,55,36],[64,8,57,6],[64,12,57,10],[64,13,57,11,"token"],[64,18,57,16],[64,20,57,18],[65,10,58,8,"setStatus"],[65,19,58,17],[65,20,58,18,"DEFAULT_STATUS"],[65,34,58,32],[65,35,58,33],[66,10,59,8],[67,8,60,6],[68,8,62,6],[68,14,62,12,"response"],[68,22,62,20],[68,25,62,23],[68,31,62,29,"fetch"],[68,36,62,34],[68,37,62,35],[68,40,62,38,"BACKEND_URL"],[68,52,62,49],[68,53,62,49,"BACKEND_URL"],[68,64,62,49],[68,90,62,75],[68,92,62,77],[69,10,63,8,"headers"],[69,17,63,15],[69,19,63,17],[70,12,63,19,"Authorization"],[70,25,63,32],[70,27,63,34],[70,37,63,44,"token"],[70,42,63,49],[71,10,63,52],[72,8,64,6],[72,9,64,7],[72,10,64,8],[73,8,66,6],[73,12,66,10,"response"],[73,20,66,18],[73,21,66,19,"ok"],[73,23,66,21],[73,25,66,23],[74,10,67,8],[74,16,67,14,"data"],[74,20,67,18],[74,23,67,21],[74,29,67,27,"response"],[74,37,67,35],[74,38,67,36,"json"],[74,42,67,40],[74,43,67,41],[74,44,67,42],[75,10,68,8,"setStatus"],[75,19,68,17],[75,20,68,18,"data"],[75,24,68,22],[75,25,68,23],[76,10,69,8,"setError"],[76,18,69,16],[76,19,69,17],[76,23,69,21],[76,24,69,22],[77,8,70,6],[77,9,70,7],[77,15,70,13],[78,10,71,8],[79,10,72,8,"setStatus"],[79,19,72,17],[79,20,72,18,"DEFAULT_STATUS"],[79,34,72,32],[79,35,72,33],[80,8,73,6],[81,6,74,4],[81,7,74,5],[81,8,74,6],[81,15,74,13,"err"],[81,18,74,16],[81,20,74,18],[82,8,75,6,"console"],[82,15,75,13],[82,16,75,14,"error"],[82,21,75,19],[82,22,75,20],[82,52,75,50],[82,54,75,52,"err"],[82,57,75,55],[82,58,75,56],[83,8,76,6,"setStatus"],[83,17,76,15],[83,18,76,16,"DEFAULT_STATUS"],[83,32,76,30],[83,33,76,31],[84,8,77,6,"setError"],[84,16,77,14],[84,17,77,15],[84,54,77,52],[84,55,77,53],[85,6,78,4],[85,7,78,5],[85,16,78,14],[86,8,79,6,"setLoading"],[86,18,79,16],[86,19,79,17],[86,24,79,22],[86,25,79,23],[87,6,80,4],[88,4,81,2],[88,5,81,3],[88,7,81,5],[88,9,81,7],[88,10,81,8],[89,4,83,2],[89,8,83,2,"useEffect"],[89,14,83,11],[89,15,83,11,"useEffect"],[89,24,83,11],[89,26,83,12],[89,32,83,18],[90,6,84,4,"fetchStatus"],[90,17,84,15],[90,18,84,16],[90,19,84,17],[91,4,85,2],[91,5,85,3],[91,7,85,5],[91,8,85,6,"fetchStatus"],[91,19,85,17],[91,20,85,18],[91,21,85,19],[92,4,87,2],[92,10,87,8,"refresh"],[92,17,87,15],[92,20,87,18],[92,24,87,18,"useCallback"],[92,30,87,29],[92,31,87,29,"useCallback"],[92,42,87,29],[92,44,87,30],[92,50,87,36],[93,6,88,4,"fetchStatus"],[93,17,88,15],[93,18,88,16],[93,19,88,17],[94,4,89,2],[94,5,89,3],[94,7,89,5],[94,8,89,6,"fetchStatus"],[94,19,89,17],[94,20,89,18],[94,21,89,19],[96,4,91,2],[97,4,92,2],[97,10,92,8,"isPro"],[97,15,92,13],[97,18,92,16,"status"],[97,24,92,22],[97,25,92,23,"is_pro"],[97,31,92,29],[98,4,93,2],[98,10,93,8,"canAccessPremiumLandmarks"],[98,35,93,33],[98,38,93,36,"status"],[98,44,93,42],[98,45,93,43,"limits"],[98,51,93,49],[98,52,93,50,"can_access_premium_landmarks"],[98,80,93,78],[99,4,94,2],[99,10,94,8,"canCreateCustomVisits"],[99,31,94,29],[99,34,94,32,"status"],[99,40,94,38],[99,41,94,39,"limits"],[99,47,94,45],[99,48,94,46,"can_create_custom_visits"],[99,72,94,70],[100,4,95,2],[100,10,95,8,"maxPhotosPerVisit"],[100,27,95,25],[100,30,95,28,"status"],[100,36,95,34],[100,37,95,35,"limits"],[100,43,95,41],[100,44,95,42,"photos_per_visit"],[100,60,95,58],[101,4,96,2],[101,10,96,8,"maxFriends"],[101,20,96,18],[101,23,96,21,"status"],[101,29,96,27],[101,30,96,28,"limits"],[101,36,96,34],[101,37,96,35,"max_friends"],[101,48,96,46],[102,4,97,2],[102,10,97,8,"friendsRemaining"],[102,26,97,24],[102,29,97,27,"status"],[102,35,97,33],[102,36,97,34,"usage"],[102,41,97,39],[102,42,97,40,"friends_remaining"],[102,59,97,57],[103,4,98,2],[103,10,98,8,"isAtFriendLimit"],[103,25,98,23],[103,28,98,26,"status"],[103,34,98,32],[103,35,98,33,"usage"],[103,40,98,38],[103,41,98,39,"friends_remaining"],[103,58,98,56],[103,62,98,60],[103,63,98,61],[104,4,100,2],[104,11,100,9],[105,6,101,4,"status"],[105,12,101,10],[106,6,102,4,"loading"],[106,13,102,11],[107,6,103,4,"error"],[107,11,103,9],[108,6,104,4,"refresh"],[108,13,104,11],[109,6,105,4],[110,6,106,4,"isPro"],[110,11,106,9],[111,6,107,4,"canAccessPremiumLandmarks"],[111,31,107,29],[112,6,108,4,"canCreateCustomVisits"],[112,27,108,25],[113,6,109,4,"maxPhotosPerVisit"],[113,23,109,21],[114,6,110,4,"maxFriends"],[114,16,110,14],[115,6,111,4,"friendsRemaining"],[115,22,111,20],[116,6,112,4,"isAtFriendLimit"],[117,4,113,2],[117,5,113,3],[118,2,114,0],[119,0,114,1],[119,3]],"functionMap":{"names":["<global>","getToken","useSubscription","fetchStatus","useEffect$argument_0","refresh"],"mappings":"AAA;iBCK;CDK;OEoC;kCCK;GD6B;YEE;GFE;8BGE;GHE;CFyB"},"hasCjsExports":false},"type":"js/module"}]}