{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":102,"index":102}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"../utils/purchases","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":144},"end":{"line":15,"column":28,"index":370}}],"key":"5NnEHi2cAT3z8tKMfqdcQqtumWw=","exportNames":["*"],"imports":1}},{"name":"./AuthContext","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":16,"column":0,"index":371},"end":{"line":16,"column":40,"index":411}}],"key":"YmpzODa+dVz64UAAYTI+RwJeEt0=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/contexts/PurchaseContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  exports.PurchaseProvider = PurchaseProvider;\n  exports.usePurchases = usePurchases;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _utilsPurchases = require(_dependencyMap[1], \"../utils/purchases\");\n  var _AuthContext = require(_dependencyMap[2], \"./AuthContext\");\n  var _reactJsxDevRuntime = require(_dependencyMap[3], \"react/jsx-dev-runtime\");\n  const PurchaseContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  function PurchaseProvider({\n    children\n  }) {\n    const {\n      user\n    } = (0, _AuthContext.useAuth)();\n    const [isInitialized, setIsInitialized] = (0, _react.useState)(false);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const [isPro, setIsPro] = (0, _react.useState)(false);\n    const [offerings, setOfferings] = (0, _react.useState)(null);\n    const [customerInfo, setCustomerInfo] = (0, _react.useState)(null);\n\n    // Initialize on mount\n    (0, _react.useEffect)(() => {\n      initialize();\n    }, []);\n\n    // Re-initialize when user changes\n    (0, _react.useEffect)(() => {\n      if (user?.user_id) {\n        initialize(user.user_id);\n      }\n    }, [user?.user_id]);\n    const initialize = async userId => {\n      try {\n        setIsLoading(true);\n        await (0, _utilsPurchases.initializePurchases)(userId);\n        setIsInitialized(true);\n\n        // Fetch initial data\n        const [offeringsData, proStatus] = await Promise.all([(0, _utilsPurchases.getOfferings)(), (0, _utilsPurchases.hasProAccess)()]);\n        setOfferings(offeringsData);\n        setIsPro(proStatus);\n        const info = await (0, _utilsPurchases.getCustomerInfo)();\n        setCustomerInfo(info);\n      } catch (error) {\n        console.error('[PurchaseContext] Initialization error:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    const refresh = (0, _react.useCallback)(async () => {\n      setIsLoading(true);\n      try {\n        const [proStatus, info] = await Promise.all([(0, _utilsPurchases.hasProAccess)(), (0, _utilsPurchases.getCustomerInfo)()]);\n        setIsPro(proStatus);\n        setCustomerInfo(info);\n      } catch (error) {\n        console.error('[PurchaseContext] Refresh error:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    }, []);\n    const purchase = (0, _react.useCallback)(async pkg => {\n      setIsLoading(true);\n      try {\n        const result = await (0, _utilsPurchases.purchasePackage)(pkg);\n        if (result.success) {\n          setIsPro(true);\n          if (result.customerInfo) {\n            setCustomerInfo(result.customerInfo);\n          }\n          return true;\n        }\n        return false;\n      } catch (error) {\n        console.error('[PurchaseContext] Purchase error:', error);\n        return false;\n      } finally {\n        setIsLoading(false);\n      }\n    }, []);\n    const restore = (0, _react.useCallback)(async () => {\n      setIsLoading(true);\n      try {\n        const result = await (0, _utilsPurchases.restorePurchases)();\n        if (result.success) {\n          setIsPro(true);\n          if (result.customerInfo) {\n            setCustomerInfo(result.customerInfo);\n          }\n          return true;\n        }\n        return false;\n      } catch (error) {\n        console.error('[PurchaseContext] Restore error:', error);\n        return false;\n      } finally {\n        setIsLoading(false);\n      }\n    }, []);\n    const value = {\n      isInitialized,\n      isLoading,\n      isPro,\n      offerings,\n      customerInfo,\n      isMockMode: _utilsPurchases.MOCK_PURCHASES,\n      purchase,\n      restore,\n      refresh\n    };\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(PurchaseContext.Provider, {\n      value: value,\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 5\n    }, this);\n  }\n  function usePurchases() {\n    const context = (0, _react.useContext)(PurchaseContext);\n    if (context === undefined) {\n      throw new Error('usePurchases must be used within a PurchaseProvider');\n    }\n    return context;\n  }\n  var _default = PurchaseContext;\n});","lineCount":140,"map":[[8,2,164,0,"Object"],[8,8,164,0],[8,9,164,0,"defineProperty"],[8,23,164,0],[8,24,164,0,"exports"],[8,31,164,0],[9,4,164,0,"enumerable"],[9,14,164,0],[10,4,164,0,"get"],[10,7,164,0],[10,18,164,0,"get"],[10,19,164,0],[11,6,164,0],[11,13,164,0,"_default"],[11,21,164,0],[12,4,164,0],[13,2,164,0],[14,2,33,0,"exports"],[14,9,33,0],[14,10,33,0,"PurchaseProvider"],[14,26,33,0],[14,29,33,0,"PurchaseProvider"],[14,45,33,0],[15,2,156,0,"exports"],[15,9,156,0],[15,10,156,0,"usePurchases"],[15,22,156,0],[15,25,156,0,"usePurchases"],[15,37,156,0],[16,2,1,0],[16,6,1,0,"_react"],[16,12,1,0],[16,15,1,0,"require"],[16,22,1,0],[16,23,1,0,"_dependencyMap"],[16,37,1,0],[17,2,3,0],[17,6,3,0,"_utilsPurchases"],[17,21,3,0],[17,24,3,0,"require"],[17,31,3,0],[17,32,3,0,"_dependencyMap"],[17,46,3,0],[18,2,16,0],[18,6,16,0,"_AuthContext"],[18,18,16,0],[18,21,16,0,"require"],[18,28,16,0],[18,29,16,0,"_dependencyMap"],[18,43,16,0],[19,2,16,40],[19,6,16,40,"_reactJsxDevRuntime"],[19,25,16,40],[19,28,16,40,"require"],[19,35,16,40],[19,36,16,40,"_dependencyMap"],[19,50,16,40],[20,2,31,0],[20,8,31,6,"PurchaseContext"],[20,23,31,21],[20,39,31,24],[20,43,31,24,"createContext"],[20,49,31,37],[20,50,31,37,"createContext"],[20,63,31,37],[20,65,31,71,"undefined"],[20,74,31,80],[20,75,31,81],[21,2,33,7],[21,11,33,16,"PurchaseProvider"],[21,27,33,32,"PurchaseProvider"],[21,28,33,33],[22,4,33,35,"children"],[23,2,33,69],[23,3,33,70],[23,5,33,72],[24,4,34,2],[24,10,34,8],[25,6,34,10,"user"],[26,4,34,15],[26,5,34,16],[26,8,34,19],[26,12,34,19,"useAuth"],[26,24,34,26],[26,25,34,26,"useAuth"],[26,32,34,26],[26,34,34,27],[26,35,34,28],[27,4,35,2],[27,10,35,8],[27,11,35,9,"isInitialized"],[27,24,35,22],[27,26,35,24,"setIsInitialized"],[27,42,35,40],[27,43,35,41],[27,46,35,44],[27,50,35,44,"useState"],[27,56,35,52],[27,57,35,52,"useState"],[27,65,35,52],[27,67,35,53],[27,72,35,58],[27,73,35,59],[28,4,36,2],[28,10,36,8],[28,11,36,9,"isLoading"],[28,20,36,18],[28,22,36,20,"setIsLoading"],[28,34,36,32],[28,35,36,33],[28,38,36,36],[28,42,36,36,"useState"],[28,48,36,44],[28,49,36,44,"useState"],[28,57,36,44],[28,59,36,45],[28,63,36,49],[28,64,36,50],[29,4,37,2],[29,10,37,8],[29,11,37,9,"isPro"],[29,16,37,14],[29,18,37,16,"setIsPro"],[29,26,37,24],[29,27,37,25],[29,30,37,28],[29,34,37,28,"useState"],[29,40,37,36],[29,41,37,36,"useState"],[29,49,37,36],[29,51,37,37],[29,56,37,42],[29,57,37,43],[30,4,38,2],[30,10,38,8],[30,11,38,9,"offerings"],[30,20,38,18],[30,22,38,20,"setOfferings"],[30,34,38,32],[30,35,38,33],[30,38,38,36],[30,42,38,36,"useState"],[30,48,38,44],[30,49,38,44,"useState"],[30,57,38,44],[30,59,38,62],[30,63,38,66],[30,64,38,67],[31,4,39,2],[31,10,39,8],[31,11,39,9,"customerInfo"],[31,23,39,21],[31,25,39,23,"setCustomerInfo"],[31,40,39,38],[31,41,39,39],[31,44,39,42],[31,48,39,42,"useState"],[31,54,39,50],[31,55,39,50,"useState"],[31,63,39,50],[31,65,39,72],[31,69,39,76],[31,70,39,77],[33,4,41,2],[34,4,42,2],[34,8,42,2,"useEffect"],[34,14,42,11],[34,15,42,11,"useEffect"],[34,24,42,11],[34,26,42,12],[34,32,42,18],[35,6,43,4,"initialize"],[35,16,43,14],[35,17,43,15],[35,18,43,16],[36,4,44,2],[36,5,44,3],[36,7,44,5],[36,9,44,7],[36,10,44,8],[38,4,46,2],[39,4,47,2],[39,8,47,2,"useEffect"],[39,14,47,11],[39,15,47,11,"useEffect"],[39,24,47,11],[39,26,47,12],[39,32,47,18],[40,6,48,4],[40,10,48,8,"user"],[40,14,48,12],[40,16,48,14,"user_id"],[40,23,48,21],[40,25,48,23],[41,8,49,6,"initialize"],[41,18,49,16],[41,19,49,17,"user"],[41,23,49,21],[41,24,49,22,"user_id"],[41,31,49,29],[41,32,49,30],[42,6,50,4],[43,4,51,2],[43,5,51,3],[43,7,51,5],[43,8,51,6,"user"],[43,12,51,10],[43,14,51,12,"user_id"],[43,21,51,19],[43,22,51,20],[43,23,51,21],[44,4,53,2],[44,10,53,8,"initialize"],[44,20,53,18],[44,23,53,21],[44,29,53,28,"userId"],[44,35,53,43],[44,39,53,48],[45,6,54,4],[45,10,54,8],[46,8,55,6,"setIsLoading"],[46,20,55,18],[46,21,55,19],[46,25,55,23],[46,26,55,24],[47,8,56,6],[47,14,56,12],[47,18,56,12,"initializePurchases"],[47,33,56,31],[47,34,56,31,"initializePurchases"],[47,53,56,31],[47,55,56,32,"userId"],[47,61,56,38],[47,62,56,39],[48,8,57,6,"setIsInitialized"],[48,24,57,22],[48,25,57,23],[48,29,57,27],[48,30,57,28],[50,8,59,6],[51,8,60,6],[51,14,60,12],[51,15,60,13,"offeringsData"],[51,28,60,26],[51,30,60,28,"proStatus"],[51,39,60,37],[51,40,60,38],[51,43,60,41],[51,49,60,47,"Promise"],[51,56,60,54],[51,57,60,55,"all"],[51,60,60,58],[51,61,60,59],[51,62,61,8],[51,66,61,8,"getOfferings"],[51,81,61,20],[51,82,61,20,"getOfferings"],[51,94,61,20],[51,96,61,21],[51,97,61,22],[51,99,62,8],[51,103,62,8,"hasProAccess"],[51,118,62,20],[51,119,62,20,"hasProAccess"],[51,131,62,20],[51,133,62,21],[51,134,62,22],[51,135,63,7],[51,136,63,8],[52,8,65,6,"setOfferings"],[52,20,65,18],[52,21,65,19,"offeringsData"],[52,34,65,32],[52,35,65,33],[53,8,66,6,"setIsPro"],[53,16,66,14],[53,17,66,15,"proStatus"],[53,26,66,24],[53,27,66,25],[54,8,68,6],[54,14,68,12,"info"],[54,18,68,16],[54,21,68,19],[54,27,68,25],[54,31,68,25,"getCustomerInfo"],[54,46,68,40],[54,47,68,40,"getCustomerInfo"],[54,62,68,40],[54,64,68,41],[54,65,68,42],[55,8,69,6,"setCustomerInfo"],[55,23,69,21],[55,24,69,22,"info"],[55,28,69,26],[55,29,69,27],[56,6,70,4],[56,7,70,5],[56,8,70,6],[56,15,70,13,"error"],[56,20,70,18],[56,22,70,20],[57,8,71,6,"console"],[57,15,71,13],[57,16,71,14,"error"],[57,21,71,19],[57,22,71,20],[57,63,71,61],[57,65,71,63,"error"],[57,70,71,68],[57,71,71,69],[58,6,72,4],[58,7,72,5],[58,16,72,14],[59,8,73,6,"setIsLoading"],[59,20,73,18],[59,21,73,19],[59,26,73,24],[59,27,73,25],[60,6,74,4],[61,4,75,2],[61,5,75,3],[62,4,77,2],[62,10,77,8,"refresh"],[62,17,77,15],[62,20,77,18],[62,24,77,18,"useCallback"],[62,30,77,29],[62,31,77,29,"useCallback"],[62,42,77,29],[62,44,77,30],[62,56,77,42],[63,6,78,4,"setIsLoading"],[63,18,78,16],[63,19,78,17],[63,23,78,21],[63,24,78,22],[64,6,79,4],[64,10,79,8],[65,8,80,6],[65,14,80,12],[65,15,80,13,"proStatus"],[65,24,80,22],[65,26,80,24,"info"],[65,30,80,28],[65,31,80,29],[65,34,80,32],[65,40,80,38,"Promise"],[65,47,80,45],[65,48,80,46,"all"],[65,51,80,49],[65,52,80,50],[65,53,81,8],[65,57,81,8,"hasProAccess"],[65,72,81,20],[65,73,81,20,"hasProAccess"],[65,85,81,20],[65,87,81,21],[65,88,81,22],[65,90,82,8],[65,94,82,8,"getCustomerInfo"],[65,109,82,23],[65,110,82,23,"getCustomerInfo"],[65,125,82,23],[65,127,82,24],[65,128,82,25],[65,129,83,7],[65,130,83,8],[66,8,84,6,"setIsPro"],[66,16,84,14],[66,17,84,15,"proStatus"],[66,26,84,24],[66,27,84,25],[67,8,85,6,"setCustomerInfo"],[67,23,85,21],[67,24,85,22,"info"],[67,28,85,26],[67,29,85,27],[68,6,86,4],[68,7,86,5],[68,8,86,6],[68,15,86,13,"error"],[68,20,86,18],[68,22,86,20],[69,8,87,6,"console"],[69,15,87,13],[69,16,87,14,"error"],[69,21,87,19],[69,22,87,20],[69,56,87,54],[69,58,87,56,"error"],[69,63,87,61],[69,64,87,62],[70,6,88,4],[70,7,88,5],[70,16,88,14],[71,8,89,6,"setIsLoading"],[71,20,89,18],[71,21,89,19],[71,26,89,24],[71,27,89,25],[72,6,90,4],[73,4,91,2],[73,5,91,3],[73,7,91,5],[73,9,91,7],[73,10,91,8],[74,4,93,2],[74,10,93,8,"purchase"],[74,18,93,16],[74,21,93,19],[74,25,93,19,"useCallback"],[74,31,93,30],[74,32,93,30,"useCallback"],[74,43,93,30],[74,45,93,31],[74,51,93,38,"pkg"],[74,54,93,50],[74,58,93,73],[75,6,94,4,"setIsLoading"],[75,18,94,16],[75,19,94,17],[75,23,94,21],[75,24,94,22],[76,6,95,4],[76,10,95,8],[77,8,96,6],[77,14,96,12,"result"],[77,20,96,18],[77,23,96,21],[77,29,96,27],[77,33,96,27,"purchasePackage"],[77,48,96,42],[77,49,96,42,"purchasePackage"],[77,64,96,42],[77,66,96,43,"pkg"],[77,69,96,46],[77,70,96,47],[78,8,98,6],[78,12,98,10,"result"],[78,18,98,16],[78,19,98,17,"success"],[78,26,98,24],[78,28,98,26],[79,10,99,8,"setIsPro"],[79,18,99,16],[79,19,99,17],[79,23,99,21],[79,24,99,22],[80,10,100,8],[80,14,100,12,"result"],[80,20,100,18],[80,21,100,19,"customerInfo"],[80,33,100,31],[80,35,100,33],[81,12,101,10,"setCustomerInfo"],[81,27,101,25],[81,28,101,26,"result"],[81,34,101,32],[81,35,101,33,"customerInfo"],[81,47,101,45],[81,48,101,46],[82,10,102,8],[83,10,103,8],[83,17,103,15],[83,21,103,19],[84,8,104,6],[85,8,106,6],[85,15,106,13],[85,20,106,18],[86,6,107,4],[86,7,107,5],[86,8,107,6],[86,15,107,13,"error"],[86,20,107,18],[86,22,107,20],[87,8,108,6,"console"],[87,15,108,13],[87,16,108,14,"error"],[87,21,108,19],[87,22,108,20],[87,57,108,55],[87,59,108,57,"error"],[87,64,108,62],[87,65,108,63],[88,8,109,6],[88,15,109,13],[88,20,109,18],[89,6,110,4],[89,7,110,5],[89,16,110,14],[90,8,111,6,"setIsLoading"],[90,20,111,18],[90,21,111,19],[90,26,111,24],[90,27,111,25],[91,6,112,4],[92,4,113,2],[92,5,113,3],[92,7,113,5],[92,9,113,7],[92,10,113,8],[93,4,115,2],[93,10,115,8,"restore"],[93,17,115,15],[93,20,115,18],[93,24,115,18,"useCallback"],[93,30,115,29],[93,31,115,29,"useCallback"],[93,42,115,29],[93,44,115,30],[93,56,115,60],[94,6,116,4,"setIsLoading"],[94,18,116,16],[94,19,116,17],[94,23,116,21],[94,24,116,22],[95,6,117,4],[95,10,117,8],[96,8,118,6],[96,14,118,12,"result"],[96,20,118,18],[96,23,118,21],[96,29,118,27],[96,33,118,27,"restorePurchases"],[96,48,118,43],[96,49,118,43,"restorePurchases"],[96,65,118,43],[96,67,118,44],[96,68,118,45],[97,8,120,6],[97,12,120,10,"result"],[97,18,120,16],[97,19,120,17,"success"],[97,26,120,24],[97,28,120,26],[98,10,121,8,"setIsPro"],[98,18,121,16],[98,19,121,17],[98,23,121,21],[98,24,121,22],[99,10,122,8],[99,14,122,12,"result"],[99,20,122,18],[99,21,122,19,"customerInfo"],[99,33,122,31],[99,35,122,33],[100,12,123,10,"setCustomerInfo"],[100,27,123,25],[100,28,123,26,"result"],[100,34,123,32],[100,35,123,33,"customerInfo"],[100,47,123,45],[100,48,123,46],[101,10,124,8],[102,10,125,8],[102,17,125,15],[102,21,125,19],[103,8,126,6],[104,8,128,6],[104,15,128,13],[104,20,128,18],[105,6,129,4],[105,7,129,5],[105,8,129,6],[105,15,129,13,"error"],[105,20,129,18],[105,22,129,20],[106,8,130,6,"console"],[106,15,130,13],[106,16,130,14,"error"],[106,21,130,19],[106,22,130,20],[106,56,130,54],[106,58,130,56,"error"],[106,63,130,61],[106,64,130,62],[107,8,131,6],[107,15,131,13],[107,20,131,18],[108,6,132,4],[108,7,132,5],[108,16,132,14],[109,8,133,6,"setIsLoading"],[109,20,133,18],[109,21,133,19],[109,26,133,24],[109,27,133,25],[110,6,134,4],[111,4,135,2],[111,5,135,3],[111,7,135,5],[111,9,135,7],[111,10,135,8],[112,4,137,2],[112,10,137,8,"value"],[112,15,137,34],[112,18,137,37],[113,6,138,4,"isInitialized"],[113,19,138,17],[114,6,139,4,"isLoading"],[114,15,139,13],[115,6,140,4,"isPro"],[115,11,140,9],[116,6,141,4,"offerings"],[116,15,141,13],[117,6,142,4,"customerInfo"],[117,18,142,16],[118,6,143,4,"isMockMode"],[118,16,143,14],[118,18,143,16,"MOCK_PURCHASES"],[118,33,143,30],[118,34,143,30,"MOCK_PURCHASES"],[118,48,143,30],[119,6,144,4,"purchase"],[119,14,144,12],[120,6,145,4,"restore"],[120,13,145,11],[121,6,146,4,"refresh"],[122,4,147,2],[122,5,147,3],[123,4,149,2],[123,24,150,4],[123,28,150,4,"_reactJsxDevRuntime"],[123,47,150,4],[123,48,150,4,"jsxDEV"],[123,54,150,4],[123,56,150,5,"PurchaseContext"],[123,71,150,20],[123,72,150,21,"Provider"],[123,80,150,29],[124,6,150,30,"value"],[124,11,150,35],[124,13,150,37,"value"],[124,18,150,43],[125,6,150,43,"children"],[125,14,150,43],[125,16,151,7,"children"],[126,4,151,15],[127,6,151,15,"fileName"],[127,14,151,15],[127,16,151,15,"_jsxFileName"],[127,28,151,15],[128,6,151,15,"lineNumber"],[128,16,151,15],[129,6,151,15,"columnNumber"],[129,18,151,15],[130,4,151,15],[130,11,152,30],[130,12,152,31],[131,2,154,0],[132,2,156,7],[132,11,156,16,"usePurchases"],[132,23,156,28,"usePurchases"],[132,24,156,28],[132,26,156,31],[133,4,157,2],[133,10,157,8,"context"],[133,17,157,15],[133,20,157,18],[133,24,157,18,"useContext"],[133,30,157,28],[133,31,157,28,"useContext"],[133,41,157,28],[133,43,157,29,"PurchaseContext"],[133,58,157,44],[133,59,157,45],[134,4,158,2],[134,8,158,6,"context"],[134,15,158,13],[134,20,158,18,"undefined"],[134,29,158,27],[134,31,158,29],[135,6,159,4],[135,12,159,10],[135,16,159,14,"Error"],[135,21,159,19],[135,22,159,20],[135,75,159,73],[135,76,159,74],[136,4,160,2],[137,4,161,2],[137,11,161,9,"context"],[137,18,161,16],[138,2,162,0],[139,2,164,0],[139,6,164,0,"_default"],[139,14,164,0],[139,17,164,15,"PurchaseContext"],[139,32,164,30],[140,0,164,31],[140,3]],"functionMap":{"names":["<global>","PurchaseProvider","useEffect$argument_0","initialize","refresh","purchase","restore","usePurchases"],"mappings":"AAA;OCgC;YCS;GDE;YCG;GDI;qBEE;GFsB;8BGE;GHc;+BIE;GJoB;8BKE;GLoB;CDmB;OOE;CPM"},"hasCjsExports":false},"type":"js/module"}]}